#!/usr/local/bin/slash
var successes = 0
var tests = (find "test/" -name "*.slash")
var tests_count = (echo $tests | wc -l)

make clean && make asan -j8

loop file in $tests {
    if (./slash-asan $file) as bool {
        $successes += 1
        printf '%s \033[0;32mPASSED\033[0m\n' $file
    } else {
        printf '%s \033[0;31mFAILED\033[0m\n' $file
    }
}

echo "---"
echo $successes "/" $tests_count "passed"
